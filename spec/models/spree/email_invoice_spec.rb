require 'spec_helper'

describe Spree::EmailInvoice do
  before(:each) do
    @attr = { :subject => 'PickSlip for Order # 100413334', 
      :from_address => 'orders@coffeeforless.com', 
      :message_id => '123', 
      :message_date => '2013-11-01 0:00:00', 
      :body => 'Date: F i, 29 Nov 2013 02:00:20 -0500 Mime-Ve sion: 1.0 Content-Type: text/html;  cha set=utf-8 Content-T ansfe -Encoding: 7bit Content-ID: <52983b841740e_71938739f8905b0@app1.coffeefo less.com.mail>  <div align="cente " style="colo :#2F2F2F"> <table bo de ="0" cellpadding="0" cellspacing="0" style="width:650px;colo :#2F2F2F" width="650"> <tbody></tbody> <t  style="height:78pt"></t > <td style="width:21.75pt;padding:0in;height:78pt" valign="top" width="29"> <p> <img bo de ="0" height="104" s c="http://live.coffeefo less.com/images/email-template/banne _left_end.jpg" width="29"> </p> </td> <td style="width:89.25pt;padding:0in;height:78pt" valign="top" width="119"> <p> <a h ef="http://live.coffeefo less.com/keu ig-k-cups.html/" ta get="_blank"> <span style="text-deco ation:none"> <img alt="View Keu ig K-cups at CoffeeFo Less.com" bo de ="0" height="104" s c="http://live.coffeefo less.com/images/ema il-template/banne _kcups.jpg" width="119"> </span> </a> </p> </td> <td style="width:79.5pt;padding:0in;height:78pt" valign="top" width="106"> <p> <a h ef="http://live.coffeefo less.com/coffee-pods.html/" ta get="_blank"> <span style="text-deco ation:none"> <img alt="View Coffee Pods at CoffeeFo Less.com" bo de ="0" height="104" s c="http://live.coffeefo less.com/images/email -template/banne _pods.jpg" width="106"> </span> </a> </p> </td> <td style="width:107.25pt;padding:0in;height:78pt" valign="top" width="143"> <p> <a h ef="http://live.coffeefo less.com/" ta get="_blank"> <span style="text-deco ation:none"> <img alt="Visit CoffeeFo Less.com" bo de ="0" height="104" s c="http://live.coffeefo less.com/images/email-template/bann e _logo.jpg" width="143"> </span> </a> </p> </td> <td style="width:99.75pt;padding:0in;height:78pt" valign="top" width="133"> <p> <a h ef="http://live.coffeefo less.com/g ound-coffee.html/" ta get="_blank"> <span style="text-deco ation:none"> <img alt="View G ound Coffees at CoffeeFo Less.com" bo de ="0" height="104" s c="http://live.coffeefo less.com/images/em ail-template/banne _g ound.jpg" width="133"> </span> </a> </p> </td> <td style="width:68.25pt;padding:0in;height:78pt" valign="top" width="91"> <p> <a h ef="http://live.coffeefo less.com/tea.html/" ta get="_blank"> <span style="text-deco ation:none"> <img alt="View Teas at CoffeeFo Less.com" bo de ="0" height="104" s c="http://live.coffeefo less.com/images/email-templa te/banne _tea.jpg" width="91"> </span> </a> </p> </td> <td style="width:21.75pt;padding:0in;height:78pt" valign="top" width="29"> <p> <img bo de ="0" height="104" s c="http://live.coffeefo less.com/images/email-template/banne _ ight_end.jpg" width="29"> </p> </td> </table> <table bo de ="0" cellpadding="0" cellspacing="0" id="content_table" width="650"> <tbody> <t > <td valign="top"> <h3 style="bo de -bottom: 2px solid  gb(238, 238, 238); font: 11px/1.5em Ve dana,A ial,sans-se if; font-weight:bold; pad ding-bottom: 1px;"> Pick Slip fo  O de  # 100413334 </h3> <table bo de ="0" cellpadding="0" cellspacing="0" width="100%"> <thead> <t > <th align="left" bgcolo ="#4D200D" style="colo :  gb(255, 255, 255); padding: 5px 9px 6px; bo de -width: 1px 1px medium;  bo de -style: solid solid none; bo de -colo :  gb(142, 140, 135)  gb(142, 140, 135) -moz-use-text-colo ; line-height: 1 em;" width="100%">Shipping Info mation:</th> </t > </thead> <tbody> <t > <td style="padding: 7px 9px 9px; bo de - ight: 1px solid  gb(190, 188, 183); bo de -width: 0pt 1px 1px; bo de -style: no ne solid solid; bo de -colo : -moz-use-text-colo   gb(190, 188, 183)  gb(190, 188, 183); backg ound: none  epeat sc oll 0% 0%  gb(247, 242, 236);" valign="top"> Name: Lau a McKinney <b > Company: <b > Phone numbe : 9196102207 <b > Add ess: 2110 milan st <b > new o leans, Louisiana, US, 70115 </td> </t > </tbody> </table> <b > <table bo de ="0" cellpadding="0" cellspacing="0" width="100%"> <thead> <t > <th align="left" bgcolo ="#4D200D" style="colo :  gb(255, 255, 255); padding: 5px 9px 6px; bo de -width: 1px 1px medium;  bo de -style: solid solid none; bo de -colo :  gb(142, 140, 135)  gb(142, 140, 135) -moz-use-text-colo ; line-height: 1 em;" width="100%">Shipping Method:</th> </t > </thead> <tbody> <t > <td style="padding: 7px 9px 9px; bo de - ight: 1px solid  gb(190, 188, 183); bo de -width: 0pt 1px 1px; bo de -style: no ne solid solid; bo de -colo : -moz-use-text-colo   gb(190, 188, 183)  gb(190, 188, 183); backg ound: none  epeat sc oll 0% 0%  gb(247, 242, 236);" valign="top"> Supe  Save  (4-9 days) </td> </t > </tbody> </table> <b > </b > <b > <table bo de ="0" cellpadding="0" cellspacing="0" width="650"> <thead> <t > <th align="left" bgcolo ="#4D200D" style="colo :  gb(255, 255, 255); padding: 5px 9px 6px; bo de -width: 1px 1px medium;  bo de -style: solid solid none; bo de -colo :  gb(142, 140, 135)  gb(142, 140, 135) -moz-use-text-colo ; line-height: 1 em;">SKU</th> <th align="left" bgcolo ="#4D200D" style="text-align: cente ; colo :  gb(255, 255, 255); padding: 5px 9px 6px; bo de -wi dth: 1px 1px medium; bo de -style: solid solid none; bo de -colo :  gb(142, 140, 135)  gb(142, 140, 135) -moz-use-text-c olo ; line-height: 1em;">Desc iption</th> <th align="left" bgcolo ="#4D200D" style="colo :  gb(255, 255, 255); padding: 5px 9px 6px; bo de -width: 1px 1px medium;  bo de -style: solid solid none; bo de -colo :  gb(142, 140, 135)  gb(142, 140, 135) -moz-use-text-colo ; line-height: 1 em;">O de ed</th> </t > </thead> <tbody> <t > <td style="padding: 7px 9px 9px; bo de - ight: 1px solid  gb(190, 188, 183); bo de -width: 0pt 1px 1px; bo de -style: no ne solid solid; backg ound: none  epeat sc oll 0% 0%  gb(247, 242, 236);" valign="top"> TGCON-0010-L16 </td> <td style=" padding: 7px 9px 9px; bo de - ight: 1px solid  gb(190, 188, 183); bo de -width: 0pt 1px 1px; bo de -style: n one solid solid; backg ound: none  epeat sc oll 0% 0%  gb(247, 242, 236);"> Uniq Teas Jasmine Loose Leaf Tea 1lb Bag </td> <td style="width: 30px; text-align: cente ; padding: 7px 9px 9px; bo de - ight: 1px solid  gb(190, 188, 183); bo de -wid th: 0pt 1px 1px; bo de -style: none solid solid; backg ound: none  epeat sc oll 0% 0%  gb(247, 242, 236);"> 1 </td> </t > </tbody> </table> </b > <b > <p></p> <p style="font: 11px/1.5em Ve dana,A ial,sans-se if;"> Thank you again, <b > <st ong>CoffeeFo Less.com</st ong> </b > </p> </b > </td> </t > </tbody> </table> </div>'
      }
  end
  
  it "should create" do
    invoice = Spree::EmailInvoice.create!(@attr)
  end
  
  it "has subject" do
    invoice = Spree::EmailInvoice.new(:subject => "Test")
    
    invoice.subject.blank?.should_not == true
  end
  
  it "has customer" do
    invoice = Spree::EmailInvoice.new(@attr)
      
    invoice.extract_invoice_info
    
    invoice.customer.blank?.should_not == true
  end
end
